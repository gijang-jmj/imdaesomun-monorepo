# 📄 제품 요구사항 문서 (PRD) – 임대소문

## 1. 제품 개요

| 구분           | 내용                                                                                    |
| -------------- | --------------------------------------------------------------------------------------- |
| 제품 이름      | 임대소문                                                                                |
| 제품 형태      | 웹(Next.js / Vue), 모바일 앱(Flutter), Firebase Functions 백엔드                        |
| 한 줄 정의     | 여러 공공기관 임대주택 공고를 한 곳에서 모아 보고 저장·알림을 받을 수 있는 서비스       |
| 목적           | 흩어진 임대주택 공고를 빠르고 편하게 탐색 · 저장 · 추적 → 정보격차 완화, 탐색 시간 절감 |
| 핵심 가치      | (1) 통합 조회 (2) 최신성/빠른 알림 (3) 개인 맞춤 저장 (4) 간결한 UI                     |
| 주요 지원 기관 | SH(서울), GH(경기), IH(인천), BMC(부산) – 지속 확장 가능                                |
| 비영리 여부    | 비영리 서비스                                                                           |

### 1.1 문제

개별 공사 사이트를 순차 방문하거나 수동 북마크해야 하는 비효율 존재 → 신규 공고 놓침 / 최신성 부족 / 저장·비교 어려움.

### 1.2 목표

1. 4개 공사 공고를 통합 리스트로 2초 이내 초기 로드
2. 신규 공고 발생 후 10분 이내 사용자 푸시 전달 (App / Web-푸시 범위 확장 여부 TODO)
3. 저장(즐겨찾기) 기능: 사용자는 원클릭으로 저장/취소, 저장 목록 필터·무한스크롤 제공

### 1.3 대상 사용자

| 유형             | 설명                | 세부 니즈                |
| ---------------- | ------------------- | ------------------------ |
| 청년·사회초년생  | 첫 독립·주거비 절감 | 지역/자격 관련 빠른 정보 |
| 신혼부부         | 안정적 장기 거주    | 경쟁률/기회 놓치지 않기  |
| 반복 탐색 이용자 | 수시 확인 피로      | 알림 + 저장 정리         |

## 2. 사용자 요구사항

### 2.1 핵심 사용자 시나리오

| 시나리오                                                         | 우선순위 |
| ---------------------------------------------------------------- | -------- |
| 사용자는 웹 접속 후 최신 임대 공고 목록을 스크롤하며 탐색한다    | High     |
| 특정 공고 제목 클릭 → 상세 내용(본문/첨부) 확인                  | High     |
| 로그인 후 관심 공고를 저장/취소한다                              | High     |
| 신규 공고 등록 시 푸시 알림을 수신하고 클릭하여 상세로 이동 (앱) | Medium   |
| 무한스크롤로 끊김 없이 추가 공고 로드                            | Medium   |
| 저장한 공고만 모아보고 기관별로 필터한다                         | Medium   |
| (향후) 조건(지역/유형) 기반 맞춤 알림 설정                       | Low      |

### 2.2 기능 요구사항

| 기능                | 상세                                          |
| ------------------- | --------------------------------------------- |
| 공고 통합 조회      | 기관별 최신 공고 목록 API 호출 및 병합 표시   |
| 무한 스크롤         | 추가 데이터 offset/limit 기반 로드            |
| 공고 상세           | ID 기반 조회, 본문/첨부파일 링크 제공         |
| 사용자 인증         | Google OAuth(Firebase Auth)                   |
| 공고 저장           | userId + noticeId 저장/삭제 (중복 방지)       |
| 저장 목록 조회      | 필터(corporation), 페이징(hasMore/nextOffset) |
| 푸시 토큰 등록      | FCM 토큰 등록/허용 여부 설정                  |
| (앱) 신규 공고 알림 | 크롤링 후 신규 항목 감지 → FCM Broadcast      |
| 에러/로딩 UI        | 네트워크/빈 상태 핸들링                       |
| (웹) SEO            | 메타태그/OG 이미지, 검색엔진 인덱싱           |

### 2.3 비기능 요구사항

| 범주          | 요구사항                                                                 |
| ------------- | ------------------------------------------------------------------------ |
| 성능          | 초기 리스트 10건 P75 < 2s, 추가 페이지 로드 < 1.5s                       |
| 가용성        | 크롤링/알림 기능 일 별 성공률 > 99% (모니터링 체계 TODO)                 |
| 확장성        | 기관 추가 시 코드 수정 최소 (새 컬렉션/크롤러 모듈 추가)                 |
| 보안          | 인증 없는 민감 조작 차단, App Check 검증 필수, CORS 제한                 |
| 안정성        | API 오류 시 재시도(클라이언트 1회), 사용자 공고 저장 실패 시 재시도 안내 |
| 유지보수성    | 공통 로직(shared 패키지) 재사용, 크롤러 독립 모듈화                      |
| 로그/모니터링 | Function Log + (향후) Cloud Monitoring 알람 설정 TODO                    |
| 개인정보      | 이메일/UID 외 민감정보 저장 없음 → 정책 명시 필요 TODO                   |

## 3. UI/UX 요구사항

### 3.1 화면 목록 (요약)

| 화면           | 목적             | 주요 요소                                            |
| -------------- | ---------------- | ---------------------------------------------------- |
| 홈 리스트      | 공고 탐색        | 기관 태그, 제목, 등록일, 조회수(optional)            |
| 공고 상세      | 본문 열람        | 제목, 본문 HTML, 첨부파일 링크, 저장 버튼            |
| 저장 목록      | 관심 공고 관리   | 필터(기관), 정렬(최신저장 우선), 무한스크롤          |
| 로그인 모달    | 인증             | Google 로그인 버튼 (웹), 이메일 로그인/회원가입 (앱) |
| (앱) 알림 설정 | 푸시 허용/비허용 | 토글, 상태 표시                                      |

### 3.2 상호작용 규칙

| 항목        | 정의                                                            |
| ----------- | --------------------------------------------------------------- |
| 저장 액션   | 클릭 즉시 로딩 UI                                               |
| 무한 스크롤 | 공고 하단 근접 시 다음 페이지 요청                              |
| 에러        | 네트워크 오류 안내 표시                                         |
| 로딩        | 리스트 스켈레톤 / 글로벌 로딩 스피너                            |
| 접근성      | 이미지 alt, 버튼 role, 포커스 순서 기본 적용 (세부 가이드 TODO) |

## 4. 기술 요구사항

### 4.1 전체 스택

| 계층     | 주요 기술 (요약)                                                 | 배포 방식                              |
| -------- | ---------------------------------------------------------------- | -------------------------------------- |
| 웹(Next) | Next.js, React, React Query, Zustand, Tailwind, Firebase Web SDK | Vercel (SSR)                           |
| 웹(Vue)  | Vue 3, Vite, Pinia, vue-router, Tailwind, Axios                  | Firebase Hosting (CSR)                 |
| 모바일   | Flutter, Riverpod, dio, go_router                                | Google Play Console, App Store Connect |
| 백엔드   | Firebase Functions v2, Firestore, Admin SDK                      | Firebase Deploy                        |
| 크롤링   | Cloud Scheduler + Functions 파서                                 | -                                      |
| 인증     | Firebase Auth (Google)                                           | -                                      |
| 푸시     | FCM (Broadcast, 토큰 관리)                                       | -                                      |
| 보안     | App Check, Google Secret Manager, CORS, API Key                  | -                                      |
| DevOps   | Turborepo, pnpm, ESLint, Prettier, 공통 tsconfig                 | -                                      |

### 4.2 데이터 모델 (요약)

| 엔티티      | 주요 필드                                           | 비고                                  |
| ----------- | --------------------------------------------------- | ------------------------------------- |
| Notice      | id, title, department, regDate, hits, corporation   | id prefix: sh/gh/bmc/ih + 원본 식별자 |
| SavedNotice | userId, noticeId, savedAt                           | 중복 방지 unique(userId, noticeId)    |
| FcmToken    | token, userId(optional), allowed, device, updatedAt | 허용여부 필드                         |
| ScrapeMeta  | corporation, lastSuccessTs                          | 상태 모니터링                         |

### 4.3 API (요약)

| 그룹   | 엔드포인트 예                     | 목적              |
| ------ | --------------------------------- | ----------------- |
| 공고   | /getShNotices ... /getNoticeById  | 조회              |
| 저장   | /saveNotice /getSavedNotices      | 저장/삭제/목록    |
| 알림   | /registerFcmToken /sendFcmToAll   | 토큰/브로드캐스트 |
| 시스템 | /scrapeNotices /getLatestScrapeTs | 크롤링/상태       |

> 상세는 API 명세서 참고 (TODO: 링크)

### 4.4 아키텍처 흐름

1. Cloud Scheduler → `/scrapeNotices` 호출
2. Functions: 각 기관 페이지 크롤링 → 신규 항목 diff 계산 → Firestore 저장 → 신규 발생 시 FCM 발송
3. 클라이언트(웹/앱): 목록 API 호출 → 무한스크롤 추가 로드
4. 저장 액션: `/saveNotice` → Firestore Saved 컬렉션 → UI 즉시 반영
5. 푸시 클릭 → 공고 상세 딥링크 (앱) 또는 웹 상세

## 5. 일정

### 5.1 모바일 (Flutter)

| 단계 | 기간               |
| ---- | ------------------ |
| 설계 | 2025.05.06 ~ 05.17 |
| 구현 | 2025.05.18 ~ 06.09 |
| QA   | 2025.06.10 ~ 06.11 |
| 출시 | 2025.06.11 ~       |

### 5.2 웹 (Vue)

| 단계 | 기간               |
| ---- | ------------------ |
| 설계 | 2025.07.10 ~ 07.11 |
| 구현 | 2025.07.12 ~ 07.16 |
| QA   | 2025.07.17 ~ 07.18 |
| 오픈 | 2025.07.18 ~       |

### 5.3 웹 (Next.js)

| 단계 | 기간               |
| ---- | ------------------ |
| 설계 | 2025.07.26 ~ 08.02 |
| 구현 | 2025.08.03 ~ 08.08 |
| QA   | 2025.08.09 ~ 08.10 |
| 오픈 | 2025.08.10 ~       |

### 5.4 향후 마일스톤 제안

| 마일스톤                          | 예상 |
| --------------------------------- | ---- |
| 기관 추가(예: LH), 조건 검색      | TBD  |
| 맞춤 알림(조건 기반)              | TBD  |
| 관리자 대시보드(크롤링/알림 상태) | TBD  |
| 추천/개인화(세그먼트)             | TBD  |

## 6. 테스트 계획

| 범주    | 내용                           | 도구                          |
| ------- | ------------------------------ | ----------------------------- |
| 단위    | 크롤러 파서 함수, 저장 로직    | Jest (Functions) TODO         |
| 통합    | API 호출 → Firestore 반영 검증 | Emulator Suite                |
| E2E(웹) | 공고 조회/저장/필터            | Playwright 혹은 Cypress TODO  |
| 성능    | 초기 로드/스크롤 시간 계측     | Web Vitals + Custom 로그 TODO |
| 회귀    | 배포 전 smoke 스크립트         | GitHub Action TODO            |

## 7. 개인정보/보안

| 구분        | 내용                                                                  |
| ----------- | --------------------------------------------------------------------- |
| 수집 데이터 | Firebase UID, Google 프로필 최소 정보(이메일)                         |
| 민감정보    | 없음                                                                  |
| 저장 정책   | 사용자 요청 시 계정 삭제 → 저장 공고/토큰 정리 (프로세스 문서화 TODO) |
| App Check   | 웹/앱 모두 적용 (디버그 토큰 분리)                                    |

문의 또는 수정 제안은 PR/Issue로 남겨주세요.
